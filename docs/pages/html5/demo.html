<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <canvas id="myCanvas" width="600" height="300"></canvas>
  <div id="asd"></div>
  <div>
    <button onclick="stage.clean()">clear</button>
    <button id="left">left</button>
    <button id="right">right</button>
  </div>
  
</body>
</html>
<script src="js/tool.js"></script>
<script src="js/Input.js"></script>
<script src="js/Stage.js"></script>
<script src="js/Loader.js"></script>
<script src="js/SpriteSheet.js"></script>
<script src="js/Sprite.js"></script>
<script src="js/Shape.js"></script>
<script type="text/javascript">
  


  let stage = new Stage()
  stage.setCanvas(document.getElementById("myCanvas"))
  stage.setStageSize(600, 300)
  stage.showRuler()
  stage.drawRect(10, 10, 100, 50, {fillStyle: '#0f0'})
  stage.drawCircle(200, 35, 25, {fillStyle: '#f00', strokeStyle: '#000', lineWidth: 5})
  stage.drawText('123456789', 10, 70, {fillStyle: '#f00', font: '30px'})
  stage.drawLine([10,90], [200,100], {strokeStyle:'#00f', lineWidth:10, lineCap: 'round'})
  stage.drawLine([10,120], [200,130], {strokeStyle:'#0f0', lineWidth:5})
  stage.drawPolygon([[0,0], [50,0], [50,50], [100,50], [100,100], [50,100], [50,150], [0,150], [0,100], [-50,100], [-50,50], [0,50]], {strokeStyle:'#0f0', lineWidth:5}, {closePath: true, startPosition: [300, 100]})
  
  let shape = new Shape()
  let s1 = shape.line([100,100], [300,300], {strokeStyle: '#00f'})
  stage.draw(s1.draw())
  

  let marry = {
    lefter: null, 
    righter: null
  }

  let loader = new Loader({publicPath:'images/'})
  loader.program((rate, id) => { console.log(rate, id) })
  loader.ready(() => { 
    console.log('资源加载完成') 
    //document.querySelector('#asd').appendChild(loader.get('002.png'))
    //stage.drawImage(loader.get('003.png'), 0, 0, 202, 205, 10, 220, 80, 80)
    let mry = new SpriteSheet(loader.get('marry.png'), [[1,1,1],[1,1,1]], {id: 'marry', x: 450, y: 200, duration: 100})
    marry.lefter = mry.createChild('lefter', [3,4,5])
    marry.righter = mry.createChild('righter', [0,1,2])
    //timer()

    var sp = new Sprite({x:30, y:50, width: 100, height: 100})
    sp.addEventListener('drag', function(e){
      console.log(e,'拖动中。。。');
      
    })
    sp.draw()
    

  })
  loader.load(['001.png', '002.png', '003.png', 'marry.png'])


  let cr = 'righter';
  function timer(){
    stage.clean();
    
    marry[cr].update();
    marry[cr].draw();
    window.setTimeout(timer,100);
  }

  let input = new Input();
  input.keydown('right', function(){
    cr = 'righter'
  })
  input.keydown('left', function(){
    cr = 'lefter'
  })
  input.mousedown(document.getElementById('left'), function(){
    cr = 'lefter'
  })
  input.mousedown(document.getElementById('right'), function(){
    cr = 'righter'
  })

</script>

  

  
  
  
  
